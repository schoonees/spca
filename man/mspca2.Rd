% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/mspca2.R
\name{mspca2}
\alias{mspca2}
\title{Rank-k Sparse Principal Components Analysis}
\usage{
mspca2(
  Z,
  k = 2,
  c = 1,
  maxit = 20,
  eps = sqrt(.Machine$double.eps),
  center = TRUE,
  scale = FALSE,
  deflation = c("Witten", "Shen")
)
}
\arguments{
\item{Z}{Matrix to be decomposed}

\item{k}{Required rank of the result}

\item{c}{L1-norm bound for V (greater than or equal to 1), either length-1, or 
with k entries (one for each component). Feasible solutions are available 
for values greater than or equal to 1. For values larger than \code{sqrt(ncow(Z)}, it has no effect.}

\item{maxit}{Maximum number of iterations}

\item{eps}{Stopping criterion, and absolute error tolerance on the mean squared reconstruction error}

\item{center}{Logical indicating whether to column-centre the matrix Z}

\item{scale}{Logical indicating whether to set the standard deviations of the columns of Z equal
to one before analysis}
}
\value{
A list with the following components:
\describe{
 \item{scores}{The data matrix after projection to the principal component space}
 \item{loadings}{The matrix of component loadings}
 \item{sdev}{The standard deviations of each of the principal components}
 \item{pve}{Data frame giving the proportion of variance explained by the obtained components}
}
}
\description{
This is an experimental version of \code{\link{mspca}}. It (1) modifies the deflation algorithm
and (2) experiments with a "relaxed" lasso. This is not properly tested yet.
}
\details{
Multifactor version of the rank-1 SPCA of \code{\link{spca}}.Cmponents are found by 
applying \code{\link{spca}} to the original matrix after deflation by deducting 
the components already found. It is possible to apply different penalties to 
different components.

This is similar to \code{\link[PMA]{SPC}}, but differs especially with respect to
the centring of the matrix.
}
\examples{

## Random matrix example, with n > p
set.seed(1)
Z <- matrix(rnorm(100), nrow = 20, ncol = 5)

## Witten deflation
spca:::mspca2(Z, c = 1.25, k = 5)

## Shen deflation
spca:::mspca2(Z, c = 1.25, k = 5)

## Random matrix example with n < p
Z2 <- matrix(rnorm(100), nrow = 5, ncol = 20)
spca:::mspca2(Z2, c = 2.5, k = 5)

## Example with different c for components 1 and 2
spca:::mspca2(Z, k = 2, c = c(1.5, 1.1))

## Comparison to PCA
summary(prcomp(Z2))
spca:::mspca2(Z2, k = 5, c = max(dim(Z2)))$pve

}
